{
  "hash": "b4dcd7f1cac6977e15f4a63955de45c6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Transformação de Variáveis Unidimensionais\"\nformat: \n  revealjs:\n    width: 1600\n    height: 900\n    footer: \"\"\n    theme: quartomonothemer.scss\n    slide-number: c/t\n    show-slide-number: all\n    preview-links: auto\n    self-contained: false\n    embed-resources: false\n  beamer:          # Slides em PDF (LaTeX/Beamer)\n    aspectratio: 169   # 16:9\n    keep-tex: true     # opcional, guarda o .tex gerado\nincremental: false\ncode-link: true\nbibliography: references.bib\ntitle-slide-attributes:\n    data-background-image: /images/back.png\n    data-background-size: cover\n    data-background-opacity: \"0.3\"\nexecute:\n  echo: true\n  freeze: auto\n---\n\n\n## Função de Variável Aleatória\n\n\nSe $X$ é uma variável aleatória com função densidade acumulada $F_x(x)$, então qualquer função de $X$, por exemplo, $g(X)$ também é uma variável aleatória.\n\n. . .\n\nGeralmente, $g(X)$ é de nosso interesse e denotamos $Y = g(X)$ para indicar a nova variável aleatória $g(X)$.\n\n\n. . .\n\n\nUma vez que $Y$ é uma função de $X$, podemos descrever o comportamento probabilístico de $Y$ em termos de $X$, isto é, para um dado conjunto $A$,\n\n$$P(Y \\in A) = P(g(X) \\in A)$$\n  \nmostrando que a distribuição de $Y$ depende das funções $F_X$ e $g$.\n\n\n## Função de Variável Aleatória\n\n\nFormalmente, ao escrevermos $y = g(x)$, a função $g(x)$ define uma função no suporte original de $X$, denotado por $S_X$, para um novo espaço amostral, denotado por $S_Y$, o suporte de $Y$.\n\n. . .\n\nSeja então a função inversa de $g$, denotada por $g^{-1}$, que é uma função de $S_y$ para $S_x$.\n\n$$g^{-1}(y)=\\{x : g(x) = y \\}$$\n  \n  . . .\n\nPortanto, a função inversa consiste no conjunto de valores de $X$, para os quais $g(x) = y$, dado um valor de $y$ fixado do suporte de $Y$, que é a variável aleatória obtida pela transformação de interesse, $g(X)$.\n\n\n## Função de Variável Aleatória\n\nÉ importante observar que cada valor de $x$ pertencente ao suporte de $X$, corresponde a um único valor de $y$ pertencente ao suporte de $Y$. Por outro lado, um valor $y \\in S_Y$ pode corresponder a mais de um valor do suporte de $X$, conforme ilustra a figura abaixo\n\n\n![](/images/funcao_var_alea.png){fig-align=\"center\"}\n\n\n## Função de Variável Aleatória\n\nFinalmente, se a variável aleatória $Y$ for definida por $Y= g(X)$, podemos escrever para qualquer conjunto $A \\subset S_Y$,\n\n$$\n\\begin{aligned}\nP(Y \\in A) &= P(g(X) \\in A) \\\\\n           &= P(\\{x \\in S_X : g(x) \\in A\\}) \\\\\n           &= P(X \\in g^{-1}(A))\n\\end{aligned}\n$$\n\n  \n  \nIsto define a distribuição de probabilidade de $Y$.\n\n## Função de Variável Aleatória: Caso Discreto\n\nSe $X$ for uma variável aleatória discreta e $Y= g(X)$, então $Y$ também será uma variável aleatória discreta. Assim,\n\n$$p_Y(y) = P(Y = y) = \\sum_{x \\in g^{-1}(y)} p_X(x), \\qquad \\text{para} \\,\\, y \\in S_Y$$\n  e $p_Y(y) = 0$ para $y \\notin S_Y$.\n\n\n## Função de Variável Aleatória: Caso Discreto\n\n**Exemplo 01:** Suponhamos que a distribuição de probabilidades da variável aleatória $X$ é dada pela tabela abaixo:\n  \n::: {.table .striped}\n| $x$         | -2  | -1  |  0  |  1  |  2  |  3  |\n|---------------|-----|-----|-----|-----|-----|-----|\n| $p_X(x)$    | 0,1 | 0,2 | 0,2 | 0,3 | 0,1 | 0,1 |\n:::\n\nSeja $Y = 3X+1$. Encontre a distribuição da variável aleatória $Y$.\n\n\n. . .\n\n**Solução:**\n  \nComo $Y = 3X+1$, \n\n::: {.table .striped}\n| $y = 3x + 1$ | -5  | -2  | 1   | 4   | 7   | 10  |\n|----------------|-----|-----|-----|-----|-----|-----|\n| $p_Y(y)$     | 0,1 | 0,2 | 0,2 | 0,3 | 0,1 | 0,1 |\n:::\n\n  \n  \n## Função de Variável Aleatória: Caso Discreto\n  \n**Exemplo 02:** Considere a mesma distribuição de probabilidades da variável aleatória $X$, dada pela tabela abaixo:\n  \n::: {.table .striped}\n| $x$        | -2  | -1  |  0  |  1  |  2  |  3  |\n|----------------|-----|-----|-----|-----|-----|-----|\n| $p_X(x)$   | 0,1 | 0,2 | 0,2 | 0,3 | 0,1 | 0,1 |\n:::\n\nContudo, vamos agora definir a variável aleatória $Y = X^2$. Qual a distribuição de probabilidades de $Y$?\n  \n  \n. . .\n  \n\n**Solução:**\n  \n  Temos que $S_X = \\{-2, -1, 0, 1, 2, 3\\}$. Como $Y = X^2$, temos que o suporte de $Y$ é dado por $S_Y = \\{0, 1, 4, 9\\}$, de forma que a distribuição da variável $Y$ será dada por:\n  \n  \n## Função de Variável Aleatória: Caso Discreto\n  \n$$\n\\begin{aligned}\nP(Y = 0) &= P(X = 0) = 0{,}2 \\\\[6pt]\nP(Y = 1) &= P(X = -1) + P(X = 1) = 0{,}5 \\\\[6pt]\nP(Y = 4) &= P(X = -2) + P(X = 2) = 0{,}2 \\\\[6pt]\nP(Y = 9) &= P(X = 3) = 0{,}1\n\\end{aligned}\n$$\n\n  \n  Logo, \n\n::: {.table .striped}\n| $y = x^{2}$ | 0   | 1   | 4   | 9   |\n|---------------|-----|-----|-----|-----|\n| $p_Y(y)$    | 0,2 | 0,5 | 0,2 | 0,1 |\n:::\n  \n  \n  \n## Função de Variável Aleatória: Caso Discreto\n  \n**Exemplo 03:** Suponha que $X \\sim Poisson(\\lambda)$, com função de probabilidade\n\n$$\nP(x | \\lambda)=\n  \\begin{cases}\n\\dfrac{e^{-\\lambda} \\lambda^x}{x!}, & x \\in \\{0, 1, 2, 3, \\cdots \\} \\\\[6pt]\n0, & c.c.\n\\end{cases}\n$$\n  \nConsidere que $Y = g(X)$, tal que $g(X) = 0$, se $x$ é par e $g(X) = 1$, se $x$ é ímpar. Obter a função de probabilidade de $Y$.\n\n. . .\n\n\n**Solução:**\n  \nTemos que o conjunto suporte de $Y$ é $S_Y = \\{0,1\\}$. Vamos calcular a $P(Y = 0)$.\n\n\n## Função de Variável Aleatória: Caso Discreto\n\n\n$$\n\\begin{aligned}\nP(Y = 0)\n &= P(g(X) = 0)\n  = P(X \\text{ ser par}) \\\\[6pt]\n &= \\sum_{x \\in \\{0,2,4,\\ldots\\}}\n    \\frac{e^{-\\lambda}\\lambda^{x}}{x!} \\\\[6pt]\n &= e^{-\\lambda}\n    \\sum_{k = 0}^{\\infty}\n    \\frac{\\lambda^{2k}}{(2k)!}.\n\\end{aligned}\n$$\n\n  \n  \n## Aparte — Séries de Taylor e Maclaurin\n  \n  \n### Série de Taylor\n  Expansão de uma função em torno de um ponto $a$:\n  \n  \n  A expansão de Taylor escrita termo a termo é:\n  \n  \n$$\n{\\small\n\\begin{aligned}\n    f(x) &= f(a)\n    + f'(a)(x-a)\n+ \\frac{f''(a)}{2!}(x-a)^2\n+ \\frac{f^{(3)}(a)}{3!}(x-a)^3 + \\cdots = \\sum_{n=0}^{\\infty} \\frac{f^{(n)}(a)}{n!}(x-a)^n\n\\end{aligned}\n}\n$$\n\n\n\n## Aparte — Séries de Taylor e Maclaurin\n\n\n### Série de Maclaurin\n\nCaso particular da série de Taylor com $a = 0$:\n\n\n$$ f(x) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)}(0)}{n!}x^n $$\n\n\nExemplos:\n\n\n$$\ne^x\n= 1\n+ x\n+ \\frac{x^2}{2!}\n+ \\frac{x^3}{3!}\n+ \\frac{x^4}{4!}\n+ \\frac{x^5}{5!}\n+ \\cdots\n+ \\frac{x^n}{n!}\n+ \\cdots= \\sum_{n=0}^{\\infty} \\frac{x^n}{n!}\n$$\n\n$$\ne^{-x}\n= 1\n- x\n+ \\frac{x^2}{2!}\n- \\frac{x^3}{3!}\n+ \\frac{x^4}{4!}\n- \\frac{x^5}{5!}\n+ \\cdots\n+ (-1)^n \\frac{x^n}{n!}\n+ \\cdots = \\sum_{n=0}^{\\infty} (-1)^n \\frac{x^n}{n!}\n$$\n\n## Função de Variável Aleatória: Caso Discreto\n\nAssim, $e^{\\lambda} + e^{-\\lambda} = 2\\sum_{k=0}^{\\infty} \\frac{\\lambda^{2k}}{(2k)!}$ e,\n\n$$\n\\begin{aligned}\nP(Y = 0)\n &= e^{-\\lambda} \\sum_{k = 0}^{\\infty} \\frac{\\lambda^{2k}}{(2k)!} \\\\[6pt]\n &= e^{-\\lambda} \\cdot \\frac{1}{2}\\Big(e^{\\lambda} + e^{-\\lambda}\\Big) \\\\[6pt]\n &= \\frac{1}{2}\\Big(1 + e^{-2\\lambda}\\Big).\n\\end{aligned}\n$$\n\n\n## Função de Variável Aleatória: Caso Discreto\n\n\nComo $\\sum_{y=0}^{\\infty} P(Y = y) = 1$, temos que\n\n\n$$\n\\begin{aligned}\nP(Y = 1)\n &= P(X \\text{ ser ímpar})\n  = 1 - \\frac{1}{2}\\Big(1 + e^{-2\\lambda}\\Big) \\\\[6pt]\n &= \\frac{1}{2}\\Big(1 - e^{-2\\lambda}\\Big).\n\\end{aligned}\n$$\n\n. . .\n\n\n\nFinalmente, $p_Y(y) = 0$ para outros valores de $y \\notin S_Y$. Portanto, $Y \\sim Bernoulli(p)$ com\n\n$$p = \\dfrac{1}{2}\\Big(1 - e^{-2\\lambda}\\Big), \\qquad \\lambda > 0$$\n\n\n\n## Função de Variável Aleatória: Caso Discreto\n\n**Exemplo 04:** Considere que $X \\sim Binomial (n,p)$ com função de probabilidade\n\n\n$$\nP(x | n,p)=\n\\begin{cases}\n\\dbinom{n}{x}\\, p^{x}\\, (1-p)^{\\,n-x}, \\qquad x \\in \\{0, 1, 2, \\dots, n\\}  \\\\[6pt]\n0, & c.c.\n\\end{cases}\n$$\n\n\nConsidere $Y = g(X) = n - X$ e obtenha a distribuição de probabilidade de $Y$.\n\n\n. . . \n\n\n**Solução:**\n\nConsiderando $Y = g(X) = n - X$, temos que $S_Y = \\{0, 1, 2, \\dots, n\\}$. Quando $Y =  y$, temos $X = n-y$, assim,\n\n\n\n## Função de Variável Aleatória: Caso Discreto\n\n\n$$\n\\begin{aligned}\nP(Y = y) &= P(g(X) = y) = P(X = g^{-1}(y)) = P(X = n - y) \\\\\n         &= \\binom{n}{\\,n-y\\,}\\, p^{\\,n-y}\\, (1-p)^{\\,n-(n-y)} \\\\\n         &= \\binom{n}{\\,n-y\\,}\\, p^{\\,n-y}\\, (1-p)^{\\,y} \\\\\n         &= \\binom{n}{y}\\, (1-p)^{y}\\, p^{\\,n-y}, \n         \\qquad \\text{uma vez que } \\binom{n}{n-y} = \\binom{n}{y}\n\\end{aligned}\n$$\n\n\nque equivale a dizer que $Y \\sim binomial(n, 1-p)$.\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n### Método da Função de Distribuição\n\n\n**Teorema:** Consideremos uma variável aleatória contínua $X$ com função de distribuição de probabilidade $F_X$ conhecida e a função $g: \\mathbb{R} \\rightarrow \\mathbb{R}$, então $Y = g(X)$ é uma variável aleatória com função distribuição dada por\n\n$$F_Y(y) = P(Y \\le y) = P(X \\in g^{-1}\\big((-\\infty, y]\\big) = \\int_{g^{-1}\\big((-\\infty, y]\\big)}f_X(x)\\,\\,dx$$\n\nem que $g^{-1}(y)$ é a função inversa de $g$.\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n\n- Esse método consiste em encontrar a função de distribuição da variável transformada $Y = g(X)$ a partir da função de distribuição de $X$.\n\n\n- Se $Y$ for variável aleatória continua, podemos então obter a sua função densidade a partir da derivada da função de distribuição já encontrada.\n\n- Não necessariamente $Y = g(X)$ será variável aleatória contínua, $Y$ por ser contínua, discreta e até mesmo uma variável aleatória que não seja nem discreta nem contínua.\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Exemplo 05:** Considere que $X \\sim Exp(\\lambda)$, sendo $\\lambda > 0$ conhecido, com função densidade de probabilidade dada por\n\n$$\nf_X(x| \\lambda) =\n\\begin{cases}\n\\lambda \\,\\, e^{-\\lambda x} & \\text{para } x > 0  \\\\[6pt] \n0, & c.c.\n\\end{cases}\n$$\nPara $Y = g(X)$ dada por\n\n$$\nY = g(X) =\n\\begin{cases}\n0 & \\text{se }  X \\le \\dfrac{1}{\\lambda}  \\\\[6pt] \n1, & c.c.\n\\end{cases}\n$$\nobter a distribuição de $Y$.\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Solução:**\n\nComo o evento $\\{Y = 0\\}$ ocorre quando $X \\le 1/\\lambda$ e a função de distribuição exponencial é $F_X(x) = 1 - \\exp(-\\lambda x)$, então\n\n$$P(Y=0) = F_X\\Bigg( \\dfrac{1}{\\lambda}\\Bigg) = 1 - \\exp \\Bigg(-\\lambda \\times \\dfrac{1}{\\lambda}\\Bigg) = 1-e^{-1}$$\n\nTemos então, que \n\n\n$$P(Y = 1) = 1 - F_X\\Bigg( \\dfrac{1}{\\lambda}\\Bigg) = 1 - (1 - e^{-1}) = e^{-1}$$\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nLogo, $Y$ é uma variável aleatória discreta, pois $S_Y = \\{0,1\\}$. Além disso, $Y \\sim Bernoulli(p = e^{-1})$, com *fp* dada por\n\n\n$$\np_Y(y) =\n\\begin{cases}\np^y(1-p)^{1-y} & \\text{para } y \\in \\{0,1\\}  \\\\[6pt] \n0, & c.c.\n\\end{cases}\n$$\ncom $p = e^{-1}$.\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Exemplo 06:** Seja $X$ uma variável aleatória tal que $X \\sim N(0,1)$, cuja *fdp* é dada por\n\n$$f_X(x) = \\dfrac{1}{\\sqrt{2\\pi}}\n\\exp\\left( -\\dfrac{x^2}{2} \\right), \\quad x \\in \\mathbb{R}$$\n\n\nConsiderando $Y = g(X) = X^2$, obter a função densidade de probabilidade de $Y$.\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Solução:** \n\nTemos que o evento $\\{Y \\le y\\}$, para $y$ fixado e pertencente ao conjunto suporte $S_Y = [0, \\infty) \\subset \\mathbb{R}$, cuja equivalência em relação aos eventos pertencentes ao suporte de $X$, $S_X = \\mathbb{R}$, é dada por $\\{Y \\le y\\} = \\{-\\sqrt{y} \\le X \\le \\sqrt{y}\\}$, conforme ilustrado abaixo\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](transformacoes_files/figure-revealjs/unnamed-chunk-1-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nPortanto,\n\n$$F_Y(y) = P(Y \\le y) = P(-\\sqrt{y} \\le X \\le \\sqrt{y}) = \\Phi_X(\\sqrt{y}) - \\Phi_X(-\\sqrt{y})$$\npara $y > 0$, sendo $\\Phi_X$, a função de distribuição de probabilidade da normal padrão. \n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nSe derivarmos $F_y(y)$ em relação a $y$, e usando o fato de $\\Gamma\\Big(\\frac{1}{2}\\Big) =  \\sqrt{\\pi}$, temos\n\n$$\\small\n\\begin{aligned}\nf_Y(y)\n &= \\frac{dF_Y(y)}{dy}\n   = \\frac{d\\Big[ \\Phi_X(\\sqrt{y}) - \\Phi_X(-\\sqrt{y}) \\Big]}{dy} \\\\[6pt]\n &= f_X(\\sqrt{y}) \\cdot \\frac{1}{2\\sqrt{y}}\n  + f_X(-\\sqrt{y}) \\cdot \\frac{1}{2\\sqrt{y}}\n   \\qquad \\text{(regra da cadeia)} \\\\[6pt]\n &= f_X(\\sqrt{y}) \\cdot \\frac{1}{\\sqrt{y}}\n   \\qquad \\text{(simetria da normal)} \\\\[6pt]\n &= \\frac{1}{\\sqrt{2\\pi}}\n    \\exp\\!\\left( -\\frac{(\\sqrt{y})^{2}}{2}\\right)\n    \\cdot \\frac{1}{\\sqrt{y}} = \\frac{1}{2^{1/2}\\sqrt{\\pi}}\\,e^{-y/2}\\,y^{-1/2} = \\chi^2_1(y).\n\\end{aligned}\n$$\n\n## Função de Variável Aleatória: Caso Contínuo\n\n### Método do Jacobiano\n\n**Teorema:** Seja $X$ com *fdp* $f_X(x)$ e $Y=g(X)$, onde $g$ é uma função monótona. Sejam $S_X = \\{x: f_X(x) > 0\\}$ e $S_Y = \\{y: y = g(x) \\,\\, \\text{para algum } \\, x \\in S_X\\}$. Suponha que $f_X(x)$ seja contínua em $S_X$ e que $g^{-1}(y)$ tenha uma derivada contínua em $S_Y$. Então,\n\n\n$$\nf_Y(y) =\n\\begin{cases}\nf_X \\Big(g^{-1}(y)\\Big) \\Bigg|\\dfrac{d}{dy}g^{-1}(y)\\Bigg| & y \\in S_Y  \\\\[6pt] \n0, & c.c.\n\\end{cases}\n$$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Exemplo 07:** Suponha uma variável aleatória contínua\n$$\nX \\sim N(\\mu, \\sigma^2), \\quad \\sigma > 0.\n$$\n\n\nSua função densidade é\n$$\nf_X(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}}\n\\exp\\left( -\\frac{(x - \\mu)^2}{2\\sigma^2} \\right), \\quad x \\in \\mathbb{R}\n$$\n\nDefinimos a nova variável aleatória\n$$\nY = \\frac{X - \\mu}{\\sigma}.\n$$\n\nQueremos encontrar a distribuição de $Y$ usando o **método do jacobiano**.\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Passo 1:** Escrever a transformação e a inversa\n\nA transformação é\n$$\nY = g(X) = \\frac{X - \\mu}{\\sigma}.\n$$\n\nIsolando $X$ em função de $Y$, obtemos a inversa:\n$$\nX = \\sigma Y + \\mu.\n$$\n\nIsto é,\n$$\nx = g^{-1}(y) = \\sigma y + \\mu.\n$$\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Passo 2:** Calcular o jacobiano em 1D\n\n\nNo caso unidimensional, o jacobiano é o valor absoluto da derivada de $x$ em relação a $y$:\n$$\n\\dfrac{d}{dy} x= \\dfrac{d}{dy} \\,\\sigma y + \\mu  =  \\sigma \\quad \\Rightarrow \\quad \\left| \\dfrac{d}{dy} \\,\\sigma y + \\mu \\right| = \\sigma\n$$\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Passo 3:** Para $Y = g(X)$ com $g$ monotônica, a densidade de $Y$ é dada por\n\n$$\nf_Y(y) = f_X\\big(g^{-1}(y)\\big)\\,\\left|\\frac{d}{dy} g^{-1}(y)\\right|\n$$\n\nNo nosso caso:\n\n$$\n\\begin{aligned}\nf_Y(y)\n &= f_X(\\sigma y + \\mu)\\,\\sigma \\\\[6pt]\n &= \\frac{1}{\\sigma\\sqrt{2\\pi}}\n    \\exp\\!\\left(\n      -\\frac{(\\sigma y + \\mu - \\mu)^2}{2\\sigma^2}\n    \\right)\\,\\sigma \\\\[6pt]\n &= \\frac{1}{\\sigma\\sqrt{2\\pi}}\n    \\exp\\!\\left(\n      -\\frac{(\\sigma y)^2}{2\\sigma^2}\n    \\right)\\,\\sigma = \\frac{1}{\\sqrt{2\\pi}}\n    \\exp\\!\\left( -\\frac{y^2}{2} \\right).\n\\end{aligned}\n$$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nLogo,\n$$\nf_Y(y) = \\sigma \\cdot \\dfrac{1}{\\sigma \\sqrt{2\\pi}}\n\\exp\\left( -\\dfrac{\\sigma^2 y^2}{2\\sigma^2} \\right)\n= \\dfrac{1}{\\sqrt{2\\pi}}\n\\exp\\left( -\\dfrac{y^2}{2} \\right), \\quad y \\in \\mathbb{R}\n$$\n\n\nque é exatamente a densidade da **Normal Padrão**.\n\nPortanto,\n$$\nY = \\frac{X - \\mu}{\\sigma} \\sim N(0,1).\n$$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Exemplo 08:** Seja $X \\sim U(0,1)$. Obtenha a função densidade de $Y = -\\ln(X)$. \n\n. . .\n\n**Solução:**\n\n\nSabemos que se $X \\sim U(0,1)$, então sua função densidade $f_X(x)$ é dada por\n\n$$\nf_X(x) =\n\\begin{cases}\n1, & 0 < x < 1, \\\\\n0, & \\text{caso contrário.}\n\\end{cases}\n$$\n\n\nTemos que $Y = -\\ln(X)$. Como $0 < X < 1$, então $Y > 0$.\n\nInvertendo:\n\n$$\nY = -\\ln(X) \\;\\Rightarrow\\; -Y = \\ln(X) \\;\\Rightarrow\\; X = e^{-Y}\n$$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nPortanto:\n\n$$\nx = g^{-1}(y) = e^{-y}\n$$\n\n**Jacobiano**\n\n\n$$\n\\dfrac{d}{dy} x = \\dfrac{d}{dy} e^{-y} = -e^{-y} \\quad \\Rightarrow \\quad \\left| \\dfrac{d}{dy} x \\right| = e^{-y}\n$$\n\nTemos que\n\n\n$$\nf_Y(y) = f_X(g^{-1}(y)) \\left| \\frac{d}{dy} g^{-1}(y) \\right|\n$$\n\n## Função de Variável Aleatória: Caso Contínuo\n\n\nSubstituindo:\n\n$$\nf_Y(y) = f_X(e^{-y}) \\cdot e^{-y}\n$$\n\numa vez que $f_X(x) = 1$ no intervalo $(0, 1)$. \n\n$$\nf_Y(y) = 1 \\cdot e^{-y} = e^{-y}, \\quad y > 0.\n$$\n\n\nTemos que $Y \\sim Exp(\\lambda = 1)$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n### Generalização do Método do Jacobiano\n\n\nSe $Y = g(X)$ não é monótona em $\\mathbb{R}$, podemos aplicar o método do Jacobiano em cada um dos intervalos em que $g$ é monótona, da seguinte forma:\n\n1) Defina uma partição de $\\mathbb{R}_X$ formada pelos intervalos $I_1, I_2, \\cdots I_k$ tais que a função $g$ é monótona em cada $I_j, \\,\\,\\, j= 1\\cdots k$. \n\n2) Obtenha $f_j(y) = f_X \\Big(g^{-1}(y)\\Big) \\Bigg|\\dfrac{d}{dy}g^{-1}(y)\\Bigg|$ a cada intervalo $I_j$.\n\n3) Finalmente, obtenha\n\n$$f_Y(y) = \\sum_{j=1}^k f_j(y)$$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Exemplo 09:** **(Exemplo 06 revisitado)** Seja $X$ uma variável aleatória tal que $X \\sim N(0,1)$, cuja *fdp* é dada por\n\n$$f_X(x) = \\dfrac{1}{\\sqrt{2\\pi}}\n\\exp\\left( -\\dfrac{x^2}{2} \\right), \\quad x \\in \\mathbb{R}$$\n\n\nConsiderando $Y = g(X) = X^2$, obter a função densidade de probabilidade de $Y$, usando o **método do Jacobiano**.\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Solução:**\n\nNote que, neste caso, temos duas regiões disjuntas do suporte de $X$, $S_X$, em que $g(x) = x^2$ é injetora. Temos, $S_{X_1} = (-\\infty, 0]$ e $S_{X_2} = [0, \\infty)$. Logo, $g^{-1}_1(y) = -\\sqrt{y}$ para $x \\le 0$ e $g^{-1}_2(y) = \\sqrt{y}$ para $x > 0$. Portanto,\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n$$\n\\begin{aligned}\nf_Y(y)\n &= f_X(g_1^{-1}(y)) \\left| \\frac{d}{dy} g_1^{-1}(y) \\right|\n  + f_X(g_2^{-1}(y)) \\left| \\frac{d}{dy} g_2^{-1}(y) \\right| \\\\[6pt]\n &= \\frac{1}{\\sqrt{2\\pi}}\n    \\exp\\!\\left( -\\frac{(-\\sqrt{y})^2}{2} \\right)\n    \\left| \\frac{d}{dy} (-\\sqrt{y}) \\right|\n  + \\frac{1}{\\sqrt{2\\pi}}\n    \\exp\\!\\left( -\\frac{(\\sqrt{y})^2}{2} \\right)\n    \\left| \\frac{d}{dy} \\sqrt{y} \\right| \\\\[6pt]\n &= \\frac{1}{\\sqrt{2\\pi}}\n    \\exp\\!\\left( -\\frac{y}{2} \\right)\n    \\left| -\\frac{1}{2 \\sqrt{y}} \\right|\n  + \\frac{1}{\\sqrt{2\\pi}}\n    \\exp\\!\\left( -\\frac{y}{2} \\right)\n    \\left| \\frac{1}{2 \\sqrt{y}}  \\right| \\\\[6pt]\n &= \\frac{1}{\\sqrt{2\\pi}}\n    e^{-y/2}\\,\\frac{1}{2 \\sqrt{y}}\n  + \\frac{1}{\\sqrt{2\\pi}}\n    e^{-y/2}\\,\\frac{1}{2 \\sqrt{y}} \\\\[6pt]\n &= \\frac{2}{\\sqrt{2\\pi}}\\,e^{-y/2}\\,\\frac{1}{2 \\sqrt{y}} = \\frac{1}{\\sqrt{2\\pi}}\\,e^{-y/2}\\,y^{-1/2}\n  = \\frac{1}{2^{1/2}\\sqrt{\\pi}}\\,e^{-y/2}\\,y^{-1/2}\n  = \\chi^2_1(y).\n\\end{aligned}\n$$\n\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n**Exemplo 10:** Seja $X\\sim U(-1,1)$. Qual a distribuição de $Y=X^2$?\n\n. . .\n\n**Solução:**\n\nDefinindo a função indicadora de um conjunto $A$ como\n\n$$\nI_A(x) =\n\\begin{cases}\n1, & \\text{se } x \\in A, \\\\\n0, & \\text{se } x \\notin A\n\\end{cases}\n$$\n\npodemos escrever a fução densidade de $X$ como $f_X(x) = \\dfrac{1}{2}I_{(-1,1)}(x)$.\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nComo $Y = X^2$ não é monótona em $(−1, 1)$, mas o é em $(−1, 0)$ e $(0, 1)$ podemos utilizar a generalização do método do Jacobiano, ou seja, no intervalo $(−1, 0)$, $g_1^{-1}(y) = -\\sqrt{y}$ e no intervalo $(0, 1)$ $g_2^{-1}(y) = \\sqrt{y}$. Assim,\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\n\n$$\n\\begin{aligned}\nf_Y(y)\n &= f_X(g_1^{-1}(y)) \\left| \\frac{d}{dy} g_1^{-1}(y) \\right|\n  + f_X(g_2^{-1}(y)) \\left| \\frac{d}{dy} g_2^{-1}(y) \\right| \\\\[6pt]\n &= f_X(-\\sqrt{y}) \\left| \\frac{d}{dy} (-\\sqrt{y}) \\right|\n  + f_X(\\sqrt{y}) \\left| \\frac{d}{dy} \\sqrt{y} \\right| \\\\[6pt]\n &= \\frac{1}{2} \\cdot \\left| -\\frac{1}{2 \\sqrt{y}} \\right|\n  + \\frac{1}{2} \\cdot \\left| \\frac{1}{2 \\sqrt{y}} \\right| \\\\[6pt]\n &= \\frac{1}{2} \\cdot \\frac{1}{2 \\sqrt{y}}\n  + \\frac{1}{2} \\cdot \\frac{1}{2 \\sqrt{y}} \\\\[6pt]\n &= \\frac{1}{4 \\sqrt{y}} + \\frac{1}{4 \\sqrt{y}}\n  = \\frac{1}{2 \\sqrt{y}}, \\qquad 0<y<1\n\\end{aligned}\n$$\n\n\n## Função de Variável Aleatória: Caso Contínuo\n\nLogo, se $X\\sim U(-1,1)$, a distribuição de $Y=X^2$ é dada por\n\n\n$$f_Y(y) = \\dfrac{1}{2 \\sqrt{y}}I_{(0,1)}(y)$$\n\n\nque é exatamente a densidade $Beta(1/2, 1).$\n\n. . .\n\n\nAssim, se $X\\sim U(-1,1)$, $Y=X^2 \\sim Beta(1/2, 1).$\n\n## A Transformação Integral\n\nUm importante e conhecido teorema é o **Teorema da Probabilidade Integral**, que relaciona a distribuição uniforme contínua com todas as outras distribuições de probabilidade.\n\n. . .\n\nSeu resultado é importante na **Estatística Computacional**, pois permite que sejam simuladas amostras aleatórias de qualquer distribuição de probabilidade.\n\n\n\n## A Transformação Integral\n\n**Teorema da probabilidade integral:** Consideremos $X$ uma variável aleatória absolutamente contínua com função de distribuição acumulada $F_X$. Então $U = F_X(X)$ possui distribuição uniforme no intervalo $[0,1]$. Por outro lado, se $U \\sim U(0,1)$, então $X = F^{-1}_X(U)$ possui função de distribuição acumulada $F_X$.\n\n\n## A Transformação Integral\n\n\n**Demonstração:** Considere $X$ uma variável aleatória absolutamente contínua com função de distribuição acumulada $F_X$, então\n\n$$\nF_U(u) = P(U \\le u)= P(F_X(X) \\le u) = P(X \\le F_X^{-1}(u)) = F_X(F_X^{-1}(u)) = u\n$$\nPor outro lado, se $U \\sim U(0,1)$, então\n\n$$\n{\\small  \nP(X \\le x) = P(F^{-1}_X(U) \\le x) = P(U \\le F_X(x)) = F_U(F_X(x)) = F_X(x), \\,\\, \\text{pois } U \\text{ é uniforme} \n}\n$$\nAssim $X$ possui função de distribuição $F_X$.\n\n\n\n## A Transformação Integral\n\n\n**Exemplo 11:** **(Geração de variáveis da distribuição exponencial)** Considere que $X \\sim Exp(\\lambda)$, cuja função de distribuição de probabilidade é dada por\n\n$$ F_X(x) = 1 - e^{-\\lambda x}, \\qquad x \\ge 0 $$\n\n\nSe $U \\sim U(0,1)$, qual é a distribuição de $X = F_X^{-1}(U)$?\n\n\n. . .\n\n\n**Solução:**\n\nA função inversa é dada por\n\n\n$$\nu = 1 - e^{-\\lambda x} \\Rightarrow e^{-\\lambda x} = 1 - u \\Rightarrow x = -\\frac{1}{\\lambda} \\ln(1-u)\n$$\n\n\n## A Transformação Integral\n\nAssim, pelo teorema da transformação integral, \n\n\n$$X = F_X^{-1}(U) = -\\frac{1}{\\lambda} \\ln(1-U)$$ possui distribuição exponencial com função de distribuição $F_X$. Podemos utilizar esse resultado para gerar realizações de uma amostra aleatória da distribuição exponencial. Para isso, basta gerarmos realizações uniformes $u$ e aplicarmos a relação anterior.\n\n\n## A Transformação Integral\n\n\n**Exemplo 12:** **(Geração de variáveis da distribuição Weibull)**  Considere que $X \\sim Weibull(\\alpha, \\beta)$, cuja função de distribuição de probabilidade é dada por\n\n$$F_X(x) = 1 - e^{-(x/\\alpha)^{\\beta}}, \\qquad x \\ge 0$$\n\n\nSe $U \\sim U(0,1)$, qual é a distribuição de $X = F_X^{-1}(U)$?\n\n\n. . .\n\n\n**Solução:**\n\nA função inversa é dada por\n\n\n$$\nu = 1 - e^{-(x/\\alpha)^{\\beta}} \\Rightarrow e^{-(x/\\alpha)^{\\beta}} = 1 - u \\Rightarrow (x/\\alpha)^{\\beta} = -\\ln(1-u) \\Rightarrow x = \\alpha \\,[-\\ln(1-u)]^{1/\\beta}\n$$\n\n\n## A Transformação Integral\n\nAssim, pelo teorema da transformação integral, \n\n\n$$X = F_X^{-1}(U) = \\alpha \\,[-\\ln(1-U)]^{1/\\beta}$$ possui distribuição Weibull com função de distribuição $F_X$.\n\n\n\n\n",
    "supporting": [
      "transformacoes_files\\figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}